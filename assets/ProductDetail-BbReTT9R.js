import{_ as N,C as P,r as u,o as x,z as A,a,t as r,b as o,u as v,f as q,h as m,B,w as $,A as D,m as f,g as S,e as l}from"./index-ekTNfpBJ.js";import{e as E}from"./emptyImg-CXXJHA4n.js";const M={class:"product-detail"},O={key:0,class:"center"},R={key:1,class:"center error"},T={key:2,class:"content"},V={class:"media"},U=["src","alt"],z=["src"],J={class:"info"},G={class:"title"},H={class:"price"},K={key:0,class:"description"},L={class:"controls"},W={class:"qty"},Y=["disabled"],j={key:0,class:"stock"},F=["disabled"],Q=["disabled"],X={key:3,class:"center"},Z={__name:"ProductDetail",setup(ee){const k=P(),y=B(),_=k.params.id,e=u(null),d=u(!1),i=u(null),s=u(1);async function h(c){d.value=!0,i.value=null;try{const t=await S(c);t?e.value=t:i.value="Product not found."}catch(t){i.value="Error loading product.",console.error(t)}finally{d.value=!1}}console.log(e);function g(){e.value?.stock!=null&&s.value>=e.value.stock||s.value++}function b(){s.value>1&&s.value--}function w(){if(!e.value)return;const c={id:e.value.id,name:e.value.product,price:e.value.price,qty:s.value,image:e.value.image};try{const t=localStorage.getItem("cart"),n=t?JSON.parse(t):[],p=n.find(I=>I.id===c.id);p?p.qty=Math.min(e.value.stock??1/0,p.qty+c.qty):n.push(c),localStorage.setItem("cart",JSON.stringify(n)),window.alert("Added to cart")}catch(t){console.error("Could not update cart",t)}}function C(){if(!e.value)return;const c=`Hola, estoy interesado en el producto: ${e.value.product} (Cantidad: ${s.value}).`,n=`https://wa.me/543446670475?text=${encodeURIComponent(c)}`;window.open(n,"_blank")}return x(()=>{_&&h(_)}),A(e,()=>{console.log("PRODUCTO:",e.value),console.log("IMAGE_KEY:",e.value?.image_key)}),(c,t)=>(l(),a("div",M,[d.value?(l(),a("div",O,"Loading product…")):i.value?(l(),a("div",R,r(i.value),1)):e.value?(l(),a("div",T,[o("div",V,[e.value.image_key?(l(),a("img",{key:0,src:v(q)(e.value),alt:e.value.product,loading:"lazy",class:"product-image"},null,8,U)):(l(),a("img",{key:1,src:v(E),alt:""},null,8,z))]),o("div",J,[o("button",{class:"back-btn",onClick:t[0]||(t[0]=n=>v(y).back()),style:{float:"right"}},"← Back"),o("h1",G,r(e.value.product),1),o("p",H,"$"+r(e.value.price),1),e.value.description?(l(),a("p",K,r(e.value.description),1)):m("",!0),o("div",L,[o("div",W,[o("button",{onClick:b,disabled:s.value<=1},"−",8,Y),$(o("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=n=>s.value=n),min:"1"},null,512),[[D,s.value,void 0,{number:!0}]]),o("button",{onClick:g},"+"),e.value.stock!=null?(l(),a("span",j,"("+r(e.value.stock)+" in stock)",1)):m("",!0)]),o("button",{class:"add",onClick:w,disabled:e.value.stock===0},[...t[2]||(t[2]=[o("i",{class:"fa-solid fa-cart-plus"},null,-1),f(" Añadir al carrito ",-1)])],8,F),o("button",{class:"whatsApp",onClick:C,disabled:e.value.stock===0},[...t[3]||(t[3]=[o("i",{class:"fa-brands fa-whatsapp"},null,-1),f(" Pedir por WhatsApp ",-1)])],8,Q)])])])):(l(),a("div",X,"No product selected."))]))}},se=N(Z,[["__scopeId","data-v-685a7db6"]]);export{se as default};
